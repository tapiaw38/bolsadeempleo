<!DOCTYPE html>
<html lang="en">
<head>
  
  {% block head %}
    <title>Trato hecho | Tinogasta</title>
  {% endblock %}
  
  {% load static %}
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/styles.css' %}">
    <link rel="shortcut icon" type="image/png" href="{% static 'img/favicon.ico' %}"/>
</head>
<body class="body">
  <!-- Facebook -->
  {% block nav %}
  {% endblock nav%}

  {% block content %}
  {% endblock %}

  {% block footer %}
  {% endblock %}

  
  {% block js %}
  {% endblock js %}
  <script src="{% static 'js/jquery.min.js' %}"></script>
  <script src="{% static 'js/popper.js' %}"></script>
  <script src="{% static 'js/bootstrap.min.js' %}"></script>
  <script>
      //liked
      $('body').on('click', '.like',function(event){
        event.preventDefault();
        $.ajax({
        type: "POST",
        url: "{% url 'like' %}",
        data: {'service_id': $(this).attr('name'), 'csrfmiddlewaretoken': '{{ csrf_token }}'},
        dataType: "json",
        cache:false,
        beforeSend:function(){
              var audio_star = "{% static 'sound/sound_coin.mp3' %}";
              var sonido = new Audio(audio_star);
              sonido.play();
            },
        success: function(response) {
           //alert(' likes count is now ' + response.likes_count);
           var count = "";
           count+= response.likes_count;
           var id = response.service_pk;
           

           $("#service"+id).html(count);

        },
        error: function(rs, e) {
            alert(rs.responseText+ "error");
          },
        });

      });
      //delete
      $('body').on('click','.eliminar',function(event){
        event.preventDefault();
        //$(".load").show();
        if(confirm("¿Estás seguro de eliminar esté servicio?")){
          $.ajax({
            type: "POST",
            url: "{% url 'delete' %}",
            data: {'service_id': $(this).attr('name'), 'csrfmiddlewaretoken': '{{ csrf_token }}'},
            dataType: "json",
            beforeSend:function(){
              console.log("method before");
            },
            success: function(response) {
              //$(".load").show();
              console.log("method success");
              var id = response.service_pk;
              $(".none"+id).addClass("graysacale");
              $(".none"+id).hide(1000);
            }//end success

          }).always(function(){
           
          })
        }//endif
        else{
          return false;
        };
        //$("#list_json").text("");
        //ListService();
      });

      $(document).ready(function(){
        $("#sound_wsp").click(function(){
          console.log("funcion wsp");
            var audio_msj = "{% static 'sound/tono-mensaje.mp3' %}";
            var sonido = new Audio(audio_msj);
            sonido.play();
        });
      });
  </script>
</body>
</html>